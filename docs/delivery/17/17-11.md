# [17-11] Implement Docker credentials management in SecretStore

[Back to task list](./tasks.md)

## Description

Implement Docker registry credentials management methods: store, get, list, and delete Docker credentials for multiple registries (Docker Hub, GHCR, private registries).

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-10-09 00:00:00 | Created | N/A | Proposed | Task file created | AI Agent |

## Requirements

1. Implement `StoreDockerCredentials` - Store credentials for a registry
2. Implement `GetDockerCredentials` - Retrieve credentials with caching
3. Implement `ListDockerRegistries` - List all configured registries
4. Implement `DeleteDockerCredentials` - Remove registry credentials
5. Support multiple registries per user
6. Use Vault KV v2 API for versioned storage
7. Integrate with caching layer

## Implementation Plan

1. Create `docker_secrets.go` with methods
2. Use path structure: `/mirage/users/{user_id}/docker/{registry}`
3. Store DockerCredentials struct as JSON in Vault
4. Implement cache-first retrieval strategy
5. List registries by listing keys under docker path
6. Add proper error handling and logging

## Test Plan

**Success Criteria**:
- Store/get/delete credentials for multiple registries
- List returns all configured registries
- Caching works correctly
- Invalid registries handled gracefully

## Verification

- [ ] `docker_secrets.go` created
- [ ] All required methods implemented
- [ ] Caching integrated
- [ ] Code compiles and matches interface
- [ ] Logging added

## Files Modified

- `api/internal/vault/docker_secrets.go` (new)
- `api/internal/vault/client.go` (updated)

