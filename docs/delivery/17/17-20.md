# [17-20] Implement generic secrets and versioning API endpoints

[Back to task list](./tasks.md)

## Description

Create REST API endpoints for generic secret management with full version control: CRUD operations, version history, rollback, metadata management, and audit log access.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-10-09 00:00:00 | Created | N/A | Proposed | Task file created | AI Agent |

## Requirements

1. Implement `POST /api/v1/secrets` - Store generic secret
2. Implement `GET /api/v1/secrets` - List secrets with filtering
3. Implement `GET /api/v1/secrets/:key` - Get secret with metadata
4. Implement `DELETE /api/v1/secrets/:key` - Delete secret
5. Implement `GET /api/v1/secrets/:key/versions` - List versions
6. Implement `GET /api/v1/secrets/:key/versions/:version` - Get specific version
7. Implement `POST /api/v1/secrets/:key/rollback` - Rollback to version
8. Implement `GET /api/v1/secrets/health` - Vault health status
9. Implement `GET /api/v1/secrets/audit` - User's audit log
10. Add to SecretsController

## Implementation Plan

1. Add generic secret methods to SecretsController
2. Implement filtering by type and tags
3. Implement version history retrieval
4. Implement rollback (creates new version with old value)
5. Add Vault health endpoint
6. Add audit log access (requires Vault audit log parsing)
7. Register all routes

## Test Plan

**Success Criteria**:
- CRUD operations work correctly
- Version history preserved
- Rollback creates new version
- Filtering works by type and tags
- Health endpoint returns Vault status
- Audit log shows user's secret access

## Verification

- [ ] All generic secret endpoints implemented
- [ ] Version management endpoints implemented
- [ ] Health endpoint implemented
- [ ] Audit log endpoint implemented
- [ ] Filtering works
- [ ] Routes registered
- [ ] Code compiles successfully

## Files Modified

- `api/internal/controller/secrets.go` (updated)
- `api/internal/server/server.go` (updated)

