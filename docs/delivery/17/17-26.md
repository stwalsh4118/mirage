# [17-26] Implement feature flag and environment variable fallback

[Back to task list](./tasks.md)

## Description

Implement VAULT_ENABLED feature flag and maintain backward compatibility with RAILWAY_API_TOKEN environment variable. Support graceful degradation when Vault is disabled or unavailable.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-10-09 00:00:00 | Created | N/A | Proposed | Task file created | AI Agent |

## Requirements

1. Add `VAULT_ENABLED` environment variable
2. When Vault disabled, fall back to `RAILWAY_API_TOKEN` env var
3. Update controllers to handle both modes
4. Add banner in UI when Vault disabled
5. Document migration path in README
6. Ensure no breaking changes to existing deployments

## Implementation Plan

1. Add VAULT_ENABLED to config
2. Update GetRailwayClientForUser to handle disabled Vault
3. Update controllers to show different messages
4. Add UI banner when Vault disabled
5. Update environment variable documentation
6. Create migration guide

## Test Plan

**Success Criteria**:
- With VAULT_ENABLED=false, uses env var token
- With VAULT_ENABLED=true, uses Vault
- UI shows appropriate message in each mode
- No breaking changes to existing code
- Migration path documented

## Verification

- [ ] VAULT_ENABLED flag implemented
- [ ] Fallback to env var works
- [ ] Controllers handle both modes
- [ ] UI banner added
- [ ] Documentation updated
- [ ] No breaking changes

## Files Modified

- `api/internal/config/config.go` (updated)
- `api/internal/railway/user_client.go` (updated)
- `api/internal/controller/secrets.go` (updated)
- Frontend UI components (updated)
- `README.md` (updated)
- `.env.example` (updated)

