# [11-6] Implement Docker image configuration form

[Back to task list](./tasks.md)

## Description
Build the UI form for configuring Docker image-based service deployments, including registry selection, image reference input, tag/digest selection, port configuration, and environment variables.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-09-30 14:30:00 | Created | N/A | Proposed | Task file created | ai-agent |

## Requirements
- **Registry Selection**:
  - Dropdown with common registries: Docker Hub, GHCR, Custom
  - Auto-populate registry URL based on selection
  - Allow custom registry URL input
- **Image Reference Input**:
  - Text input for image name (e.g., `nginx`, `owner/repo`)
  - Format validation and helper text with examples
  - Auto-format based on registry (docker.io/nginx vs ghcr.io/owner/image)
- **Tag/Digest Selector**:
  - Input for tag (default: `latest`)
  - Toggle to use digest instead of tag
  - Validation for tag/digest format
- **Port Configuration**:
  - Array input for exposed ports
  - Add/remove port entries
  - Validation for valid port numbers (1-65535)
  - Default common ports based on image name (80 for nginx, etc.)
- **Environment Variables**:
  - Key-value pair editor (reuse existing component)
  - Add/remove rows
- **Validation**:
  - Required fields: registry, image name, tag
  - Format validation for image references
  - Validation for port numbers
- **UX Polish**:
  - Auto-format image reference as user types
  - Show full image reference preview
  - Helpful tooltips and examples
  - Clear error messages

## Implementation Plan
1. Create `DockerImageForm` component
2. Add registry selection dropdown with common options
3. Implement image name input with format validation
4. Add tag/digest input with toggle
5. Create port configuration array input
6. Integrate environment variable editor
7. Implement real-time image reference preview
8. Add format validation with regex
9. Show helpful error messages for invalid inputs
10. Add example text and tooltips
11. Style to match existing wizard aesthetics
12. Test validation and error states
13. Test with various image references

## Test Plan
### Basic Implementation Scope
- Form displays all required fields
- Registry dropdown includes Docker Hub, GHCR, Custom
- Image name validation catches invalid formats
- Tag input defaults to "latest"
- Port array allows add/remove entries
- Port validation catches invalid numbers
- Environment variable editor works correctly
- Full image reference preview is accurate
- Validation errors display clearly
- Form integrates with wizard state management

## Verification
- All form fields render correctly
- Validation works for all input types
- Invalid inputs show clear error messages
- Image reference preview updates in real-time
- Form state integrates with wizard store
- Design matches existing wizard components
- Component is responsive on mobile
- No console errors or warnings

## Files Modified
- `web/src/components/wizard/DockerImageForm.tsx` (new component)
- `web/src/components/wizard/PortArrayInput.tsx` (new component, if needed)
- `web/src/components/wizard/CreateEnvironmentDialog.tsx` (integration)
- `web/src/lib/validation/imageReference.ts` (validation utilities)

